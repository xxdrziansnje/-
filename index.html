<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>记账系统</title>
    <link rel="stylesheet" href="style.css">
    <!-- 添加 Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <!-- 添加表格样式库 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <!-- 添加 XLSX 库 -->
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>记账系统</h1>
        
        <!-- 添加记录表单 -->
        <div class="form-container">
            <h2>添加新记录</h2>
            <form id="expenseForm">
                <div class="form-group">
                    <input type="date" id="date">
                </div>
                <div class="form-group">
                    <input type="number" id="amount" placeholder="金额" required>
                </div>
                <div class="form-group">
                    <select id="type">
                        <option value="">选择类型</option>
                        <option value="income">收入</option>
                        <option value="expense">支出</option>
                    </select>
                </div>
                <div class="form-group">
                    <select id="category">
                        <option value="">选择分类</option>
                        <optgroup label="收入">
                            <option value="salary">工资</option>
                            <option value="bonus">奖金</option>
                            <option value="other-income">其他收入</option>
                        </optgroup>
                        <optgroup label="支出">
                            <option value="food">餐饮</option>
                            <option value="transport">交通</option>
                            <option value="shopping">购物</option>
                            <option value="entertainment">娱乐</option>
                            <option value="other-expense">其他支出</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" id="description" placeholder="描述">
                </div>
                <button type="submit" class="btn-add">添加</button>
            </form>
        </div>

        <!-- 统计信息 -->
        <div class="statistics">
            <div class="stat-item">
                <h3>总收入</h3>
                <p id="totalIncome">¥0</p>
            </div>
            <div class="stat-item">
                <h3>总支出</h3>
                <p id="totalExpense">¥0</p>
            </div>
            <div class="stat-item">
                <h3>结余</h3>
                <p id="balance">¥0</p>
            </div>
        </div>

        <!-- 在统计信息后面添加筛选和导出功能 -->
        <div class="filter-export">
            <div class="filter-group">
                <label for="monthFilter">按月份筛选：</label>
                <input type="month" id="monthFilter">
                <button onclick="filterByMonth()" class="btn-filter">筛选</button>
                <button onclick="clearFilter()" class="btn-filter">显示全部</button>
            </div>
            <div class="export-group">
                <button onclick="exportToExcel()" class="btn-export">导出到Excel</button>
            </div>
        </div>

        <!-- 图表区域 -->
        <div class="charts-container">
            <div class="chart-wrapper">
                <h2>收支比例</h2>
                <canvas id="pieChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <h2>每月趋势</h2>
                <canvas id="lineChart"></canvas>
            </div>
        </div>

        <!-- 记录表格 -->
        <div class="records-container">
            <h2>所有记录</h2>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>日期</th>
                            <th>类型</th>
                            <th>分类</th>
                            <th>描述</th>
                            <th>金额</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="recordsList"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 添加编辑模态框 -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>编辑记录</h2>
            <form id="editForm">
                <input type="hidden" id="editId">
                <div class="form-group">
                    <input type="date" id="editDate" required>
                </div>
                <div class="form-group">
                    <input type="number" id="editAmount" placeholder="金额" required>
                </div>
                <div class="form-group">
                    <select id="editType" required>
                        <option value="income">收入</option>
                        <option value="expense">支出</option>
                    </select>
                </div>
                <div class="form-group">
                    <select id="editCategory" required>
                        <option value="">选择分类</option>
                        <optgroup label="收入">
                            <option value="salary">工资</option>
                            <option value="bonus">奖金</option>
                            <option value="other-income">其他收入</option>
                        </optgroup>
                        <optgroup label="支出">
                            <option value="food">餐饮</option>
                            <option value="transport">交通</option>
                            <option value="shopping">购物</option>
                            <option value="entertainment">娱乐</option>
                            <option value="other-expense">其他支出</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" id="editDescription" placeholder="描述" required>
                </div>
                <button type="submit" class="btn-save">保存</button>
            </form>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html> 